All logical part goes here.
